[Interface]
PrivateKey = {{ wireguard_server_private_key }}
Address = 10.0.0.1/24
ListenPort = 51820

PostUp = iptables -A FORWARD -i wg0 -j ACCEPT
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT

SaveConfig = true

# Peer configuration will be added here
{% if wg_peers is defined %}
{% for peer in wg_peers %}
[Peer]
PublicKey = {{ peer.public_key }}
AllowedIPs = {{ peer.allowed_ips }}
Endpoint = {{ peer.endpoint }}
{% endfor %}
{% endif %}

[Peer]
PublicKey = {{ wireguard_client_public_key }}
AllowedIPs = 10.0.0.2/32 